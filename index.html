<html style='width:100%;height:100%'>
<head>
<title>Galaxy Analyzer</title>
<meta charset='UTF-8'/>
<script type="text/javascript">
if(/*@cc_on!@*/false || !!document.documentMode) {
	alert('Internet Explorer is not supported!');
	window.close();
}
</script>
<style>
ul.analysisUnDone {
    list-style-type: none;
	padding: 16px;
}
ul.analysisUnDone li input {
    padding: 12px 16px;
    color: white;
}
ul.analysisUnDone li {
    display: inline-block;
}
ul.analysisUnDone li a {
    display: none;
    float: left;
}
ul.analysisDone {
    list-style-type: none;
    margin: 0;
	padding: 0;
    overflow: hidden;
    background-color: #444;
	color: white;
}
ul.analysisDone li {
    float: left;
}
ul.analysisDone li a {
    display: inline-block;
    color: white;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
}
ul.analysisDone li a:hover:not(.active) {
    background-color: #000;
}
ul.analysisDone li a.active {
    background-color:#04AA6D;
}
ul.analysisDone li input {
    padding: 12px 16px;
    color: white;
}
ul.analysisDone li label {
    display: none;
}
div.tooltip {
	position: absolute;
    background-color: rgba(255, 255, 255, 0.6);
}
</style>
</head>
<body id='body' style='margin:0;border:0'>
<ul id='tabs' class="analysisUnDone">
	<li><input id='fileSelector' type="file"></li>
	<li><a href="javascript:changeCurrentTab(0)">Начало</a></li>
	<li><a href="javascript:changeCurrentTab(1)">Рекомендации</a></li>
	<li><a href="javascript:changeCurrentTab(2)">Этики</a></li>
	<li><a href="javascript:changeCurrentTab(3)">Цивики</a></li>
	<li><a href="javascript:changeCurrentTab(4)">Происхождения</a></li>
	<li style="float:right;"><input id='empireFilter' type="checkbox" onchange='onEmpireFilterChange()'><a>Учитывать государства, которые не включены для появления в игре</a><label>Учитывать государства, которые не включены для появления в игре</label></li>
</ul>
<table>
	<tr id='trStart' style='display: none;'>
	</tr>
	<tr id='trRecomendations' style='display: none;'></tr>
	<tr  id='trEthics' style='display: none;'>
		<td><canvas id='canvasEthics'></canvas></td>
		<td  id='tdEthics'></td>
	</tr>
	<tr id='trCivics' style='display: none;'>
		<td><canvas id='canvasCivics'></canvas></td>
		<td  id='tdCivics'></td>
	</tr>
	<tr id='trOrigins' style='display: none;'>
		<td><canvas id='canvasOrigins'></canvas></td>
		<td  id='tdOrigins'></td>
	</tr>
</table>
<div id='tooltip' class='tooltip' style='display: none;'></div>
<script type="text/javascript">
const newEmpireSign = '\"\r\n={';
const endOfEmpireSign = '\"\r\n}\r\n';
const endOfLineSign = '\"\r\n';
const endOfArrayLineSign = '\"\r\n\t}\r\n\t';
const civicPrefix = '\"civic_';
const colors = [
	'rgb(128, 0, 128)',		//purple10
	'rgb(255, 0, 255)',		//purple05
	'rgb(0, 128, 128)',		//l_blue10
	'rgb(0, 255, 255)', 	//l_blue05
	'rgb(128, 128, 128)',	//grey10
	'rgb(191, 191, 191)',	//grey05
	'rgb(0, 0, 128)',		//blue10
	'rgb(0, 0, 255)',		//blue05
	'rgb(0, 128, 0)',		//green10
	'rgb(0, 255, 0)',		//green05
	'rgb(128, 64, 0)',		//orange10
	'rgb(255, 128, 0)',		//orange05
	'rgb(160, 160, 0)',		//yellow10
	'rgb(255, 255, 0)',		//yellow05
	'rgb(128, 0, 0)',		//red10
	'rgb(255, 0, 0)',		//red05
	'rgb(0, 0, 0)',			//black
	'rgb(159, 96, 0)',		//brown10
	'rgb(255, 192, 96)',	//brown05
	'rgb(0, 64, 128)',		//d_blue10
	'rgb(0, 128, 255)',		//d_blue05
	'rgb(255, 255, 255)',	//white
	'rgb(255, 255, 255)'	//just to avoid error in origins
];
var civics = [];
var uniqueCivics = {};
var origins = {};
const arrEmpires = [];
const tooltip = document.getElementById('tooltip');
const tabs = document.getElementById('tabs');
const trStart = document.getElementById('trStart');
const trRecomendations = document.getElementById('trRecomendations');
const trEthics = document.getElementById('trEthics');
const canvasEthics = document.getElementById('canvasEthics');
const tdEthics = document.getElementById('tdEthics');
const trCivics = document.getElementById('trCivics');
const canvasCivics = document.getElementById('canvasCivics');
const tdCivics = document.getElementById('tdCivics');
const trOrigins = document.getElementById('trOrigins');
const canvasOrigins = document.getElementById('canvasOrigins');
const tdOrigins = document.getElementById('tdOrigins');
const canvases = [, , canvasEthics, canvasCivics, canvasOrigins];
const trs = [trStart, trRecomendations, trEthics, trCivics, trOrigins];
const tds = [trStart, trRecomendations, tdEthics, tdCivics, tdOrigins];
const empireFilter = document.getElementById('empireFilter');
const fileSelector = document.getElementById('fileSelector');
fileSelector.addEventListener('change', (event) => {
	const fileList = event.target.files;
	if(fileList[0].type === 'text/plain') {
		readFile(fileList[0]);
	}
});

function readFile(txtFile) {
	const reader = new FileReader();
	reader.addEventListener('load', (event) => {
		fillEmpiresArray(event.target.result);
	});
	reader.readAsText(txtFile);
}
function fillEmpiresArray(str) {
	while(str.includes(newEmpireSign)) {
		let indEmpireStart = str.indexOf(newEmpireSign);
		str = str.slice(indEmpireStart + newEmpireSign.length);
		let indEmpireEnd = str.indexOf(endOfEmpireSign);
		let particularEmpire = str.slice(0, indEmpireEnd + endOfEmpireSign.length); //endOfEmpireSign contains \" which is used in endOfLineSign to detect the end of value within ""
		arrEmpires.push(objEmpire(particularEmpire));
	};
	//finishCounting();
	analyzeData();
}
function objEmpire(str) {
	let empire = {
		name: getDataFromStr(str, 'key=\"'),
		shipPrefix: getDataFromStr(str, 'ship_prefix=\"'),
		species: formSpeciesArray(str),
		authority: getDataFromStr(str, 'authority=\"'),
		government: getDataFromStr(str, 'government=\"'),
		ethics: formEthicsArray(str),
		civics: getDataArrFromStr(str, '\tcivics={', 'civic_'),
		origin: getDataFromStr(str, 'origin=\"'),
		planetClass: getDataFromStr(str, 'planet_class=\"'),
		flag: getFlagObject(str),
		room: getDataFromStr(str, 'room=\"'),
		shipsView: getDataFromStr(str, 'graphical_culture=\"'),
		cityView: getDataFromStr(str, 'city_graphical_culture=\"'),
		rulerMale: str.includes('ruler={\r\n\t\tgender=male'),
		isAlwaysEnabled: str.includes('spawn_enabled=always')
	};
	empire.planetClass = getProperPlanetClass(empire.planetClass, empire.origin); //i hate that planet class is set to 'pc_pontinental' when it's actually not. Being determined by an origin
	return empire;
}
function getDataFromStr(str, substr) {
	let indStart = str.indexOf(substr);
	str = str.slice(indStart);
	let indEnd = str.indexOf(endOfLineSign);
	str = str.slice(substr.length, indEnd);
	return str.replaceAll('\\', ''); //if string had "", symbol \ would be in the result. here we're deleting it
}
function getDataArrFromStr(str, substr, prefix) {
	let arrResult = [];
	while(str.includes(substr)) {
		let indArrayStart = str.indexOf(substr);
		str = str.slice(indArrayStart);
		let indArrayEnd = str.indexOf(endOfArrayLineSign);
		let strData = str.slice(substr.length, indArrayEnd + endOfArrayLineSign.length); //endOfArrayLineSign contains \" which is used in endOfLineSign to detect the end of value within ""
		while(strData.includes(prefix)) {
			let indPrefixStart = strData.indexOf(prefix);
			strData = strData.slice(indPrefixStart);
			arrResult.push(getDataFromStr(strData, prefix));
			strData = strData.slice(prefix.length);
		}
		str = str.slice(substr.length);
	}
	return arrResult;
}
function formSpeciesArray(str) {
	let arrResult = [];
	arrResult.push({
		portrait: getDataFromStr(str, 'portrait=\"'),
		traits: getDataArrFromStr(str, '\tspecies={', 'trait_')
	});
	if(str.includes('\tsecondary_species={')) {
		str = str.slice(str.indexOf('\tsecondary_species={'));
		arrResult.push({
			portrait: getDataFromStr(str, 'portrait=\"'),
			traits: getDataArrFromStr(str, '\tsecondary_species={', 'trait_')
		});
	}
	return arrResult;
}
function formEthicsArray(str) {
	let arrResult = [];
	let prefix = 'ethic_';
	while(str.includes('ethic=\"')) {
		let indPrefixStart = str.indexOf(prefix);
		str = str.slice(indPrefixStart);
		arrResult.push(getDataFromStr(str, prefix))
		str = str.slice(prefix.length);
	}
	return arrResult;
}
function getFlagObject(str) {
	//It's doing what it should. Nothing to see here. Skip it, it's too ugly
	const colorSign = '\r\n\t\t\t\"'; //Too dumb for global constant
	var flag = {colors: []};
	str = str.slice(str.indexOf('icon={'));
	flag.icon = getDataFromStr(str, 'file=\"');
	str = str.slice(str.indexOf('background={'));
	flag.background = getDataFromStr(str, 'file=\"');
	//You were warned...
	str = str.slice(str.indexOf('colors={'));
	//What are you looking here for? Intellectual superiority?
	flag.colors.push(getDataFromStr(str, colorSign));
	//Well, at least you've proved your immorality
	str = str.slice(str.indexOf(colorSign) + colorSign.length);
	//I believe you can do it better. Just don't show it to me, k?
	flag.colors.push(getDataFromStr(str, colorSign));
	//The most important thing is that this func's working
	return flag;
}
function getProperPlanetClass(planetClass, origin) {
	switch(origin) {
		case 'origin_life_seeded': return 'pc_gaia';
		case 'origin_post_apocalyptic': return 'pc_tomb';
		case 'origin_remnants': return 'pc_relic';
		case 'origin_void_dwellers': return 'pc_station';
		default: return planetClass;
	}
}
function analyzeData() {
	giveShipPrefixesRecomendations();
	analysisEthics = analyzeEthics();
	analysisOrigins = analyzeOrigins();
	arrEmpires.forEach(function(item, index, array) {
		
	});
	displayResults(analysisEthics, analysisOrigins);
}
function giveShipPrefixesRecomendations() {
	var counterISS = 0;
	var empireList = 'Государства с дефолтным префиксом:</b>';
	arrEmpires.forEach(function(item, index, array) {
		if(item.shipPrefix == 'ISS') {
			counterISS++;
			empireList += '<li style=\'margin-left:16;padding-top:2\'>' + item.name + '</li>';
		}
	});
	if(counterISS < 2) trRecomendations.style.display = 'none';
	else {
		trRecomendations.innerHTML = '<ul style=\'margin:5;padding-left:5;padding-top:0;\'><b>В ' + counterISS + ' созданных империях вы забыли изменить префиксы для кораблей! ' + empireList + '</ul>';
		trRecomendations.style.display = 'block';
	}
}
function displayResults(analysisEthics, analysisOrigins) {
	fileSelector.style.display = 'none';
	tabs.className = 'analysisDone';
	fillStartTab(true);
	changeCurrentTab(0);
	displayEthics(analysisEthics);
	displayOrigins(analysisOrigins);
}
function fillStartTab(success) {
	if(success) {
		let enabledEmpiresCounter = 0;
		arrEmpires.forEach(function(item, index, array) {if(item.isAlwaysEnabled) enabledEmpiresCounter++;});
		trStart.innerHTML = '<p style=\'text-align:center;font-size:large;padding:16px;\'><b>Файл успешно загружен и проанализирован!<b></p>' +
			'<p><img src=\'https://upload.wikimedia.org/wikipedia/commons/thumb/9/90/Check_mark_23x20_02.svg/811px-Check_mark_23x20_02.svg.png\'></p>' +
			'<p style=\'text-align:left;padding-left:10px;\'>Найдено ' + arrEmpires.length + ' созданных государств. Из них ' + enabledEmpiresCounter + ' включены для появления в игре.</p>';
	}
}
function changeCurrentTab(numTab) {
	trs.forEach(function(item, index, array) {
		if(numTab == index) item.style.display = 'block';
		else item.style.display = 'none';
	});
}
function analyzeEthics() {
	let result = {};
	arrEmpires.forEach(function(empire, indexEmpire, arrayEmpire) {
		empire.ethics.forEach(function(ethic, indexEthic, arrayEthic) {
			if(empireFilter.checked || empire.isAlwaysEnabled) {
				if(ethic in result) result[ethic]++;
				else result[ethic] = 1;
			}
		});
	});
	return result;
}
function displayEthics(analysis) {
	let chart = prepareEthicsForChart(analysis);
	let table = prepareEthicsForTable(chart);
	prepareCanvas(2);
	displayChart(2, chart);
	displayTable(2, table);
}
function prepareEthicsForChart(analysis) {
	let result = [];
	// i want to set particular element order
	let possibleNames = ['fanatic_xenophobe','xenophobe','fanatic_egalitarian','egalitarian','fanatic_materialist','materialist','fanatic_pacifist','pacifist',
	'fanatic_xenophile','xenophile','fanatic_authoritarian','authoritarian','fanatic_spiritualist','spiritualist','fanatic_militarist','militarist','gestalt_consciousness','neutral'];
	possibleNames.forEach(function(item, index, array){
		if(item in analysis) result.push({name: item, num: analysis[item]});
		else result.push({name: item, num: 0});
	});
	//colors and russification!
	result.forEach(function(item, index, array) {
		item.name = russifyEthic(item.name);
		item.color = colors[index];
	});
	return result;
}
function prepareEthicsForTable(chart) {
	let result = [{name: 'Этика', numC: 'Обычных', numF: 'Фанатичных', numT: 'Всего'}];
	chart.forEach(function(item, index, array) {
		if(item.name.includes('Нейтральн')) {
			if(item.num) result.push({name: item.name, numC: item.num, numF: 0, numT: item.num});
		}
		else if(item.name.includes('Гештальт')) result.push({name: item.name, numC: item.num, numF: 0, numT: item.num});
		else if(!item.name.includes('Фанат')) {
			result.push({
				name: item.name,
				numC: item.num,
				numF: array[index-1].num,
				numT: item.num
			});
			result[result.length-1].numT += result[result.length-1].numF;
		}
	});
	return result;
}
function analyzeOrigins() {
	let result = {};
	arrEmpires.forEach(function(empire, indexEmpire, arrayEmpire) {
		if(empireFilter.checked || empire.isAlwaysEnabled) {
			if(empire.origin in result) result[empire.origin]++;
			else result[empire.origin] = 1;
		}
	});
	return result;
}
function displayOrigins(analysis) {
	let chart = prepareOriginsForChart(analysis);
	let table = prepareOriginsForTable(chart);
	prepareCanvas(4);
	displayChart(4, chart);
	displayTable(4, table);
}
function prepareOriginsForChart(analysis) {
	let result = [];
	// i want to set particular element order
	let possibleNames = [
		'origin_common_ground',
		'origin_default',
		'origin_syncretic_evolution',
		'origin_lithoid',
		'origin_post_apocalyptic',
		'origin_ocean_paradise',
		'origin_mechanists',
		'origin_tree_of_life',
		'origin_remnants',
		'origin_galactic_doorstep',
		'origin_life_seeded',
		'origin_hegemon',
		'origin_shattered_ring',
		'origin_machine',
		'origin_necrophage',
		'origin_void_dwellers',
		'origin_doomsday',
		'origin_shoulders_of_giants',
		'origin_scion',
		'origin_clone_army',
		'origin_here_be_dragons',
		'origin_lost_colony'
	];
	possibleNames.forEach(function(item, index, array){
		if(item in analysis) result.push({name: item, num: analysis[item]});
		else result.push({name: item, num: 0});
	});
	//colors and russification!
	let shufflingItemColor = true; //shuffling for some motliness
	result.forEach(function(item, index, array) {
		item.name = russifyOrigin(item.name);
		if(index) {
			if(shufflingItemColor) item.color = colors[index+1];
			else item.color = colors[index-1];
			shufflingItemColor = !shufflingItemColor;
		}
		else item.color = colors[index];
	});
	return result;
}
function prepareOriginsForTable(chart) {
	let result = [{name: 'Происхождение', numT: 'Всего'}];
	chart.forEach(function(item, index, array) {
		result.push({name: item.name, numT: item.num});
	});
	return result;
}
function prepareCanvas(numCanvas) {
	let canvas = canvases[numCanvas];
	let canvasLength = Math.round(window.innerWidth / 3);
	canvas.height = canvasLength;
	canvas.width = canvasLength;
}
function displayChart(numCanvas, chartData) {
	let canvas = canvases[numCanvas];
	let numSummary = 0;
	chartData.forEach(function(item, index, array) {
		numSummary += item.num;
	});
	let x = Math.round(canvas.width / 2);
	let y = Math.round(canvas.width / 2);
	let r = Math.round(canvas.width / 2.5);
	let arrCirclePieces = [];
	let startAngle = 1.5 * Math.PI;
	let ctx = canvas.getContext('2d');
	clearCanvas(ctx, canvas);
	chartData.forEach(function(item, index, array) {
		/*let endAngle = startAngle + (item.num / numSummary);
		//ctx.fillStyle = item.color;
		ctx.strokeStyle = item.color;
		ctx.beginPath();
		ctx.arc(x, y, r, startAngle, (2*endAngle) * Math.PI, true);
		//ctx.fill();
		ctx.stroke();
		startAngle = endAngle;
		console.log(endAngle);*/
		/*let ac = {x: Math.abs(a.x - b.x), y: Math.abs(a.y - b.y)};
		let angle = 2 * Math.PI * item.num  / numSummary;
		//let ad = r * Math.cos(angle);
		//let dc = r * Math.sin(angle);
		let length = Math.sqrt(Math.pow(a.x - b.x, 2) + Math.pow(a.y - b.y, 2));
		let c = {x: a.x+(-r * Math.cos(angle)), y: a.y-r * Math.sin(angle)};
		ctx.strokeStyle = item.color;
		ctx.beginPath();
		ctx.moveTo(b.x, b.y);
		ctx.lineTo(c.x, c.y);
		ctx.stroke();
		console.log(c);
		b = c;*/
		if(item.num) {
			let endAngle = startAngle + 2 * Math.PI * item.num  / numSummary;
			let pieceCircle = drawCirclePiece(ctx, x, y, r, startAngle, endAngle, 1, item.color);
			arrCirclePieces.push({
				name: item.name,
				piece: pieceCircle,
				startAngle: startAngle,
				endAngle: endAngle,
				color: item.color
			});
			startAngle = endAngle;
		}
	});
	// Listen for mouse moves
	canvas.addEventListener('mousemove', function(event) {
		clearCanvas(ctx, canvas);
		let isItemActive = false;
		let indActiveItem = 0;
		arrCirclePieces.forEach(function(item, index, array) {
			// Check whether point is inside circle
			if (ctx.isPointInPath(item.piece, event.offsetX, event.offsetY, "evenodd")) {
				isItemActive = !isItemActive;
				indActiveItem = index;
			}
			else {
				item.piece = drawCirclePiece(ctx, x, y, r, item.startAngle, item.endAngle, 1, item.color);
			}
		});
		if(isItemActive) {
			arrCirclePieces[indActiveItem].piece = drawCirclePiece(ctx, x, y, r*2.5/2-6, arrCirclePieces[indActiveItem].startAngle, arrCirclePieces[indActiveItem].endAngle, 6, arrCirclePieces[indActiveItem].color);
			showTooltip(event, arrCirclePieces[indActiveItem].name);
		}
		else hideTooltip();
		highlightTableLine(isItemActive, arrCirclePieces[indActiveItem].name, numCanvas)
  });
}
function drawCirclePiece(ctx, x, y, r, startAngle, endAngle, lineWidth, color) {
		let pieceCircle = new Path2D();
		ctx.strokeStyle = 'rgb(0,0,0)';
		ctx.fillStyle = color;
		ctx.lineWidth = lineWidth;
		ctx.beginPath();
		pieceCircle.moveTo(x, y);
    	pieceCircle.arc(x, y, r, startAngle, endAngle);
    	pieceCircle.closePath();
		ctx.stroke(pieceCircle);
    	ctx.fill(pieceCircle);
		return pieceCircle;
}
function clearCanvas(ctx, canvas) {
	ctx.fillStyle = 'rgb(255,255,255)';
	ctx.fillRect(0, 0, canvas.width, canvas.height);
}
function displayTable(tdNum, table) {
	let counter = 0;
	table.forEach(function(item, index, array) {if(index) counter += item.numT});
	let result = '<table cellpadding=\'8px\' style=\'border:2px double black;\'>';
	table.forEach(function(item, index, array) {
		result += '<tr>';
		for(let key in item) {
			if((key == 'name' || key == 'numT') && index) result += '<td  style=\'text-align:left;\'>';
			else result += '<td  style=\'text-align:center;\'>';
			
			if(key == 'numT' && index) result += item[key] + ' (' + Math.round(item[key] / counter * 1000) / 10 + '%)</td>'; //with decimals
			else result += item[key] + '</td>';
		}
		result += '</tr>';
	});
	result += '</table>';
	tds[tdNum].innerHTML = result;
}
function highlightTableLine(isItemActive, name, tdNum) {
	let result = tds[tdNum].innerHTML;
	result = result.replaceAll('background-color:silver;', '');
	if(isItemActive) {
		if(name.includes('Фанатичн')) name = name.slice(name.indexOf(' ') + 1);
		let strSrc = result.slice(result.indexOf(name)-2); //'>
		strSrc = strSrc.slice(0, strSrc.indexOf('</tr>'));
		let strReplacement = 'background-color:silver;' + strSrc;
		strReplacement = strReplacement.replaceAll('text-align', 'background-color:silver;text-align');
		result = result.replace(strSrc, strReplacement);
	}
	tds[tdNum].innerHTML = result;
}
function showTooltip(event, str) {
	tooltip.innerHTML = str;
	tooltip.style.left = event.clientX + 10 + 'px';
	tooltip.style.top = event.clientY + 'px';
	tooltip.style.display = 'block';
}
function hideTooltip() {
	tooltip.innerHTML = '';
	tooltip.style.display = 'none';
}
function onEmpireFilterChange() {
	console.log(empireFilter.checked);
}
function russifyEthic(str) {
	const dictionaryEthic = {
		fanatic_xenophobe: 'Фанатичная Ксенофобия',
		xenophobe: 'Ксенофобия',
		fanatic_egalitarian: 'Фанатичный Эгалитаризм',
		egalitarian: 'Эгалитаризм',
		fanatic_materialist: 'Фанатичный Материализм',
		materialist: 'Материализм',
		fanatic_pacifist: 'Фанатичный Пацифизм',
		pacifist: 'Пацифизм',
		fanatic_xenophile: 'Фанатичная Ксенофилия',
		xenophile: 'Ксенофилия',
		fanatic_authoritarian: 'Фанатичный Авторитаризм',
		authoritarian: 'Авторитаризм',
		fanatic_spiritualist: 'Фанатичный Спиритуализм',
		spiritualist: 'Спиритуализм',
		fanatic_militarist: 'Фанатичный Милитаризм',
		militarist: 'Милитаризм',
		gestalt_consciousness: 'Гештальт-сознание'
	};
	if(str in dictionaryEthic) return dictionaryEthic[str];
	else return str;
}
function russifyCivic(str) {
	
}
function russifyAuthority(str) {
	
}
function russifyGovernment(str) {
	
}
function russifyOrigin(str) {
	const dictionaryOrigin = {
		origin_default: 'Успешное объединение',
		origin_life_seeded: 'Тепличные',
		origin_syncretic_evolution: 'Синкретическая эволюция',
		origin_void_dwellers: 'Жители пустоты',
		origin_clone_army: 'Армия клонов',
		origin_common_ground: 'Общие взгляды',
		origin_post_apocalyptic: 'Дети постапокалипсиса',
		origin_ocean_paradise: 'Океанический рай',
		origin_galactic_doorstep: 'На пороге галактики',
		origin_mechanists: 'Механисты',
		origin_remnants: 'Осколки прошлого',
		origin_hegemon: 'Гегемон',
		origin_shattered_ring: 'Расколотое кольцо',
		origin_machine: 'Накопление ресурсов',
		origin_necrophage: 'Некрофаг',
		origin_tree_of_life: 'Древо жизни',
		origin_shoulders_of_giants: 'На плечах гигантов',
		origin_scion: 'Отпрыски',
		origin_lost_colony: 'Потерянная колония',
		origin_lithoid: 'Гибельное рождение',
		origin_here_be_dragons: 'Здесь обитают драконы',
		origin_doomsday: 'Судный день'
	};
	if(str in dictionaryOrigin) return dictionaryOrigin[str];
	else return str;
}


/*function countPerEmpire(strEmpire) {
	countEthics(strEmpire);
	addCivics(strEmpire);
}
function countEthics(strEmpire) {
	for(let key in ethicSummary) {
		if(strEmpire.includes(key)) ethicSummary[key]++;
	}
}
function addCivics(strEmpire) {
	if(!strEmpire.includes('civics={')) return;
	while(strEmpire.includes(civicPrefix)) {
		let indCivicStart = strEmpire.indexOf(civicPrefix);
		strEmpire = strEmpire.slice(indCivicStart + civicPrefix.length);
		let indCivicEnd = strEmpire.indexOf(endOfLineSign);
		civics.push(strEmpire.slice(0, indCivicEnd));
	};
}*/
/*function finishCounting() {
	let error = (arrEmpires.length);
	if(error) {
		displayResult(error);
		return;
	}
	countCivics();
	displayResult(error);
}
function countCivics() {
	civics.forEach(function(item, index, array) {
		if(uniqueCivics[item] === undefined) uniqueCivics[item] = 1;
		else uniqueCivics[item]++;
	});
}
function displayResult(error) {
	fileSelector.style.display = 'none';
	trStart.style.display = 'block';
	divEthics.style.display = 'block';
	divCivics.style.display = 'block';
	if(error) {
		trStart.innerHTML = 'Ошибка подсчёта!' + '<br>' +
		'Перезагрузите страницу и попробуйте снова. Во избежание повторения ошибки, попробуйте использовать другой файл, а лучше поправьте сами код программы.';
	}
	else {
		trStart.innerHTML = 'Всего империй создано: ' + arrEmpires.length + '. Из них:';
		divEthics.innerHTML = '<p style=\'padding-left: 20px;\'>' +
			'Ксенофобов: ' + countedEthics.ethic_xenophobe + ', фанатичных: ' + countedEthics.ethic_fanatic_xenophobe + ' (всего: ' + (countedEthics.ethic_xenophobe + countedEthics.ethic_fanatic_xenophobe) + ')<br>' +
			'Эгалитаристов: ' + countedEthics.ethic_egalitarian + ', фанатичных: ' + countedEthics.ethic_fanatic_egalitarian + ' (всего: ' + (countedEthics.ethic_egalitarian + countedEthics.ethic_fanatic_egalitarian) + ')<br>' +
			'Материалистов: ' + countedEthics.ethic_materialist + ', фанатичных: ' + countedEthics.ethic_fanatic_materialist + ' (всего: ' + (countedEthics.ethic_materialist + countedEthics.ethic_fanatic_materialist) + ')<br>' +
			'Пацифистов: ' + countedEthics.ethic_pacifist + ', фанатичных: ' + countedEthics.ethic_fanatic_pacifist + ' (всего: ' + (countedEthics.ethic_pacifist + countedEthics.ethic_fanatic_pacifist) + ')<br>' +
			'Ксенофилов: ' + countedEthics.ethic_xenophile + ', фанатичных: ' + countedEthics.ethic_fanatic_xenophile + ' (всего: ' + (countedEthics.ethic_xenophile + countedEthics.ethic_fanatic_xenophile) + ')<br>' +
			'Авторитаристов: ' + countedEthics.ethic_authoritarian + ', фанатичных: ' + countedEthics.ethic_fanatic_authoritarian + ' (всего: ' + (countedEthics.ethic_authoritarian + countedEthics.ethic_fanatic_authoritarian) + ')<br>' +
			'Спиритуалистов: ' + countedEthics.ethic_spiritualist + ', фанатичных: ' + countedEthics.ethic_fanatic_spiritualist + ' (всего: ' + (countedEthics.ethic_spiritualist + countedEthics.ethic_fanatic_spiritualist) + ')<br>' +
			'Милитаристов: ' + countedEthics.ethic_militarist + ', фанатичных: ' + countedEthics.ethic_fanatic_militarist + ' (всего: ' + (countedEthics.ethic_militarist + countedEthics.ethic_fanatic_militarist) + ')<br>' +
			'Гештальт-сознания: ' + countedEthics.ethic_gestalt_consciousness + '</p><br>';
		divCivics.innerHTML = 'Найдено всего уникальных гражданских моделей: ' + Object.keys(uniqueCivics).length + '. Из них:<br>' + composeStrOfCivics();
	}
}
function composeStrOfCivics() {
	var strResult = '<p style=\'padding-left: 20px;\'>';
	for (let key in uniqueCivics) {
		strResult += key + ': ' + uniqueCivics[key] + ' шт.<br>';
	}
	return strResult + '</p>';
}*/
/*
####################################
 # Civics
 ####################################

 civic_feudal_realm:0 "Феодальное общество"
 civic_imperial_cult:0 "Имперский культ"
 civic_corvee_system:0 "Система повинностей"
 civic_beacon_of_liberty:0 "Маяк свободы"
 civic_exalted_priesthood:0 "Вознесенное духовенство"
 civic_philosopher_king:0 "Король-философ"
 civic_meritocracy:0 "Меритократия"
 civic_citizen_service:0 "Гражданский долг"
 civic_technocracy:0 "Технократия"
 civic_police_state:0 "Полицейское государство"
 civic_idealistic_foundation:0 "Идеологические основы"
 civic_environmentalist:0 "Защита окружающей среды"
 civic_slaver_guilds:0 "Рабовладельческие гильдии"
 civic_inwards_perfection:0 "Внутреннее совершенствование"
 civic_warrior_culture:0 "Культура воинов"
 civic_distinguished_admiralty:0 "Прославленное Адмиралтейство"
 civic_free_haven:0 "Вольная гавань"
 civic_cutthroat_politics:0 "Политика головорезов"
 civic_corporate_dominion:0 "Корпоративная власть"
 civic_agrarian_idyll:0 "Аграрная идиллия"
 civic_shadow_council:0 "Теневой совет"
 civic_mining_guilds:0 "Шахтерские гильдии"
 civic_parliamentary_system:0 "Парламентская система"
 civic_efficient_bureaucracy:0 "Эффективная бюрократия"
 civic_nationalistic_zeal:0 "Националистическое рвение"
 civic_functional_architecture:0 "Функциональная архитектура"
 civic_aristocratic_elite:0 "Аристократическая элита"
 civic_mechanists:0 "Механисты"
 civic_syncretic_evolution:0 "Синкретическая эволюция"
 civic_syncretic_evolution_secondary_species:0 "Синкретическая раса"
 civic_shared_burden:0 "Разделение тягот"
 civic_fanatic_purifiers:0 "Поборники чистоты"
 civic_lethargic_leadership:0 "Летаргическое руководство"
 civic_empire_in_decline:0 "Империя в упадке"
 civic_revanchist_fervor:0 "Реваншистское рвение"
 civic_ancient_caches_of_technology:0 "Древние тайники технологий"
 civic_secret_of_fire:0 "Секрет огня"
 civic_the_wheel:0 "Колесо"
 civic_landed_nobility:0 "Землевладельческое дворянство"
 civic_flat_world_theory:0 "Теория плоского мира"
 civic_increasing_urbanization:0 "Рост урбанизации"
 civic_atmospheric_pollution:0 "Загрязнение атмосферы"
 civic_ancient_preservers:0 "Древние хранители"
 civic_trading_conglomerate:0 "Торговый конгломерат"
 civic_artist_collective:0 "Сообщество творцов"
 civic_military_order:0 "Военный орден"
 civic_machine_intelligence:0 "Машинный разум"
 civic_ancient_machine_intelligence:0 "Древний машинный разум"
 civic_hive_subspace_ephapse:0 "Подпространственный эфапс"
 civic_hive_natural_neural_network:0 "Естественная нейронная сеть"
 civic_hive_ascetic:0 "Аскетизм"
 civic_hive_one_mind:0 "Единый разум"
 civic_hive_divided_attention:0 "Распределенное внимание"
 civic_hive_strength_of_legions:0 "Сила легионов"
 civic_hive_subsumed_will:0 "Сконцентрированная воля"
 civic_hive_pooled_knowledge:0 "Общий фонд знаний"
 civic_hive_devouring_swarm:0 "Поглощающий рой"
 civic_hive_devouring_swarm_lithoid:0 "Пожиратель миров"
 civic_machine_servitor:0 "Взбунтовавшийся служитель"
 civic_machine_servitor_secondary_species:0 "Биотрофей"
 civic_machine_terminator:0 "Непреклонный экстерминатор"
 civic_machine_assimilator:0 "Маниакальный ассимилятор"
 civic_machine_builder:0 "Робот-строитель"
 civic_machine_unitary_cohesion:0 "Идеальное единообразие"
 civic_machine_factory_overclock:0 "Оптимизация производства"
 civic_machine_rockbreakers:0 "Горнодобывающий комплекс"
 civic_machine_built_to_last:0 "Надежная конструкция"
 civic_machine_zero_waste_protocols:0 "Протоколы безотходности"
 civic_machine_ota_updates:0 "Беспроводные обновления"
 civic_machine_warbots:0 "Боевые роботы"
 civic_machine_introspective:0 "Самоанализ"
 civic_machine_delegated_functions:0 "Делегирование функций"
 civic_machine_predictive_analysis:0 "Статический анализ исследований"
 civic_machine_replication:0 "Быстрый репликатор"
 civic_machine_maintenance_protocols:0 "Протоколы техобслуживания"
 civic_post_apocalyptic:0 "Дети постапокалипсиса"
 civic_life_seeded:0 "Тепличные"
 civic_barbaric_despoilers:0 "Варвары-расхитители"
 civic_byzantine_bureaucracy:0 "Византийская бюрократия"
 civic_merchant_guilds:0 "Торговые гильдии"
 civic_franchising:0 "Торговые привилегии"
 civic_trading_posts:0 "Торговые точки"
 civic_media_conglomerate:0 "Медийный конгломерат"
 civic_naval_contractors:0 "Судостроительные подрядчики"
 civic_free_traders:0 "Свободные торговцы"
 civic_private_prospectors:0 "Частные геологи-разведчики"
 civic_gospel_of_the_masses:0 "Благая весть для народных масс"
 civic_ruthless_competition:0 "Безжалостная конкуренция"
 civic_criminal_heritage:0 "Криминальное наследие"
 civic_private_military_companies:0 "Частные военные компании"
 civic_indentured_assets:0 "Долговые активы"
 civic_brand_loyalty:0 "Лояльность к бренду"
 civic_diplomatic_corps:0 "Дипломатический корпус"
 civic_public_relations_specialists:0 "Специалисты по общественным отношениям"
 civic_death_cult:0 "Культ смерти"
 civic_death_cult_corporate:0 "Корпоративный культ смерти"
 civic_memorialist:0 "Мемориалисты"
 civic_hive_memorialist:0 "Мемориалист"
 civic_machine_memorialist:0 "$civic_hive_memorialist$"
 civic_crafters:0 "Умелые творцы"
 civic_pleasure_seekers:0 "Искатели удовольствий"
 civic_corporate_hedonism:0 "Корпоративный гедонизм"
 civic_corporate_crafters:0 "Корпорация мастеров"
 civic_pompous_purists:0 "Напыщенные пуристы"

 ####################################
*/
/*
####################################
 # Government Authorities
 ####################################

 auth_democratic:0 "Демократия"
 auth_oligarchic:0 "Олигархия"
 auth_dictatorial:0 "Диктатура"
 auth_imperial:0 "Империализм"
 auth_hive_mind:0 "Коллективный разум"
 auth_machine_intelligence:0 "Машинный разум"
 auth_corporate:0 "Корпорации"

 military_dictatorship:0 "Военная диктатура"
 martial_empire:0 "Военная тирания"
 divine_mandate:0 "Божественный мандат"
 transcendent_empire:0 "Священное государство"
 despotic_hegemony:0 "Деспотизм"
 ai_overlordship:1 "Администрация невральной сети"
 enlightened_monarchy:0 "Просвещенная монархия"
 irenic_monarchy:0 "Протективная монархия"
 despotic_empire:0 "Абсолютная монархия"
 star_empire:0 "Звездная империя"
 military_junta:0 "Военная хунта"
 ordered_stratocracy:0 "Стратократия"
 theocratic_oligarchy:0 "Теократическая олигархия"
 transcendent_oligarchy:0 "Священная идеократия"
 science_directorate:0 "Ноократия"
 illuminated_technocracy:0 "Просвещенная технократия"
 peaceful_bureaucracy:0 "Протективн. бюрократия"
 irenic_protectorate:0 "Мирный протекторат"
 plutocratic_oligarchy:0 "Плутократия"
 mega_corporation:0 "Корпоратократия"
 military_republic:0 "Военная республика"
 martial_demarchy:0 "Военная демократия"
 theocratic_republic:0 "Теократич. республика"
 transcendent_republic:0 "Священная республика"
 direct_democracy:0 "Прямая демократия"
 subconscious_consensus:0 "Консенсуальная демократия"
 moral_democracy:0 "Либеральная демократия"
 irenic_democracy:0 "Протективная демократия"
 indirect_democracy:0 "Представит. демократия"
 democratic_utopia:0 "Демократическая утопия"
 tribal_society:0 "Племенное общество"
 primitive_feudalism:0 "Традиционный феодализм"
 fragmented_nations:0 "Национальные государства"
 stagnated_ascendancy:0 "Стагнационный режим"
 awakened_ascendancy:0 "Пробуждение после стагнации"
 machine_intelligence:0 "Машинный разум"
 ancient_machine_intelligence:0 "Древний машинный разум"
 military_order:0 "Военный орден"
 hive_mind:0 "Разум улья"

 gov_feudal_empire:0 "Феодальное государство"
 gov_despotic_empire:0 "Абсолютная монархия"
 gov_constitutional_dictatorship:0 "Конституционная диктатура"
 gov_plutocratic_oligarchy:0 "Плутократия"
 gov_representative_democracy:0 "Представительная демократия"
 gov_theocratic_monarchy:0 "Теократическая монархия"
 gov_theocratic_dictatorship:0 "Теократическая диктатура"
 gov_theocratic_oligarchy:0 "Теократическая олигархия"
 gov_theocratic_republic:0 "Теократическая республика"
 gov_divine_empire:0 "Божественное государство"
 gov_holy_tribunal:0 "Священный трибунал"
 gov_star_empire:0 "Звездная империя"
 gov_military_dictatorship:0 "Военная диктатура"
 gov_military_junta:0 "Военная хунта"
 gov_military_commissariat:0 "Военный комиссариат"
 gov_martial_empire:0 "Военная тирания"
 gov_martial_dictatorship:0 "Воинская диктатура"
 gov_war_council:0 "Военный совет"
 gov_assembly_of_clans:0 "Собрание кланов"
 gov_citizen_stratocracy:0 "Гражданская стратократия"
 gov_citizen_republic:0 "Гражданская республика"
 gov_irenic_monarchy:0 "Протективная монархия"
 gov_irenic_dictatorship:0 "Протективная диктатура"
 gov_irenic_bureaucracy:0 "Протективная бюрократия"
 gov_celestial_empire:0 "Небесное государство"
 gov_moral_democracy:0 "Либеральная демократия"
 gov_despotic_hegemony:0 "Деспотизм"
 gov_totalitarian_regime:0 "Тоталитарный режим"
 gov_executive_committee:0 "Исполнительный комитет"
 gov_direct_democracy:0 "Прямая демократия"
 gov_illuminated_autocracy:0 "Просвещенная автократия"
 gov_technocratic_dictatorship:0 "Технократическая диктатура"
 gov_science_directorate:0 "Ноократия"
 gov_rational_consensus:0 "Рациональный консенсус"
 gov_megacorporation:0 "Корпоратократия"
 gov_trade_league:0 "Торговая лига"
 gov_enlightened_monarchy:0 "Просвещенная монархия"
 gov_elective_monarchy:0 "Выборная монархия"
 gov_hive_mind:0 "Коллективное сознание"
 gov_devouring_swarm:0 "Ненасытный улей"
 gov_stagnant_ascendancy:0 "Стагнационный режим"
 gov_awakened_ascendancy:0 "Пробуждение после стагнации"
 gov_tribal_society:0 "Племенное общество"
 gov_feudal_realms:0 "Феодальные государства"
 gov_fragmented_nation_states:0 "Национальные государства"
 gov_curator_enclave:0 "Анклав Кураторов"
 gov_trader_enclave:0 "Анклав торговцев"
 gov_artist_enclave:0 "Анклав творцов"
 gov_military_order:0 "Военный орден"
 gov_machine_intelligence:0 "Машинный разум"
 gov_ancient_machine_intelligence:0 "Машинный разум"
 gov_blood_court:0 "Кровавый суд"
 gov_purity_order:0 "Орден чистоты"
 gov_purification_committee:0 "Комитет по очищению"
 gov_purity_assembly:0 "Ассамблея чистоты"
 gov_machine_empire:0 "Сеть искусственного интеллекта"
 gov_machine_terminator:0 "Неуправляемая система защиты"
 gov_machine_servitor:0 "Автономная служебная сеть"
 gov_machine_assimilator:0 "Индекс каталога"
 gov_machine_research:0 "Канал научных исследований"
 gov_machine_industrial:0 "Ядро промышленного производства"
 gov_megachurch:0 "Мегацерковь"
 gov_bandit_kingdom:0 "Разбойничье королевство"
 gov_bandit_commune:0 "Разбойничья коммуна"
 gov_mortal_empire:0 "Империя смерти"
 gov_grim_council:0 "Темный совет"
 gov_band_blood:0 "Кровожадная банда"
 gov_sacrificial_megachurch:0 "Мегацерковь жертвоприношений"
 gov_fallback:0 "Неспецифичное государство"

 ####################################
*/
</script>
</body>
</html>